---
title: "Funciones para calcular % de respuestas"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



Datos ejemplo, para cada acierto guardamos el nombre de la estación y línea, si esa estación pertenece a más de una línea aparecerán tantos registros de esa estación como a líneas pertenezca.
```{r}
respuestas<- data.frame(estacion = c("Turia", "Campus", "Empalme","Empalme",
  "Empalme","Aeroport","Aeroport","La Pobla de Farnals", "La Cova","Orriols"
  ,"A Punt","Aragó","Aragó"), linea =c(1,4,1,4,2,3,5,3,9,6,4,5,7))

```


**FUNCIÓN % aciertos sobre el total**

(1ºCalculamos cuantas estaciones han acertado es decir,contar valores totales diferentes sobre la variable estación (porque por ejem Empalme aparece 3 veces, porque pertenece a 3 líneas.)
```{r}
library(tidyverse)

porcent_total <- function(respuestas){
  num_aciertos<- respuestas %>%
  summarize(count = n_distinct(estacion))
  
  porcentaje <- num_aciertos$count*100/147 
  return(porcentaje)
}


```

**FUNCIÓN % de aciertos por líneas**
```{r}
porcent_lineas <- function(datos){
p <- c() 
num_estaci_line <- c(40,33,26,33,18,21,16,4,23,8)
for (i in 1:10){
  num <- sum(respuestas$linea == i)
  porcent <- num * 100 / num_estaci_line[i]
  p <- append(p,porcent)
}
return(p) 
}
```

Probamos con nuestros datos
```{r}
# Obtenemos los resultados
p_t <-porcent_total(respuestas)
p_l <- porcent_lineas(respuestas)

# Imprimimos el resultado
cat("Porcentaje respuestas sobre el total",p_t,"%","\n")
for (i in 1:length(p_l)){
  cat("Porcentaje respuestas Línea",i,"=",p_l[i],"%","\n")
}
```

